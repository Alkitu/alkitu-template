# Component Molecule Template

Complete template for creating Molecule components following Atomic Design methodology.

---

## File Structure

```
molecules/[component-name]/
├── [ComponentName].tsx           # Component implementation
├── [ComponentName].types.ts      # TypeScript types
├── [ComponentName].test.tsx      # Unit tests (generated by frontend-testing-expert)
├── [ComponentName].stories.tsx   # Storybook stories (generated by frontend-testing-expert)
└── index.ts                      # Barrel export
```

---

## Template: ComponentName.tsx

````typescript
'use client';

import React, { useState } from 'react';
import { cn } from '@/lib/utils';
import { Button, Input, Label } from '@/components/atoms'; // Import atoms
import type { ComponentNameProps } from './ComponentName.types';

/**
 * ComponentName - Atomic Design Molecule
 *
 * [Brief description of what this molecule does and which atoms it composes]
 *
 * @example
 * ```tsx
 * <ComponentName
 *   label="Email"
 *   placeholder="Enter your email"
 *   onChange={handleChange}
 * />
 * ```
 */
export const ComponentName = React.forwardRef<HTMLDivElement, ComponentNameProps>(
  (
    {
      // Destructure props with defaults
      variant = 'default',
      size = 'md',
      label,
      helperText,
      error,
      required = false,
      disabled = false,
      className = '',
      onChange,
      ...props
    },
    ref,
  ) => {
    // Simple internal state (if needed)
    const [value, setValue] = useState<string>('');

    // Handle change events
    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
      setValue(e.target.value);
      onChange?.(e);
    };

    // Variant classes
    const variantClasses = {
      default: 'border-input',
      error: 'border-destructive',
      success: 'border-success',
    }[variant];

    // Compose classes
    const containerClasses = cn(
      'flex flex-col gap-2',
      className,
    );

    return (
      <div ref={ref} className={containerClasses}>
        {/* Compose atoms */}
        {label && (
          <Label htmlFor={props.id} required={required}>
            {label}
          </Label>
        )}

        <Input
          {...props}
          size={size}
          value={value}
          onChange={handleChange}
          disabled={disabled}
          className={cn(variantClasses)}
          aria-invalid={!!error}
          aria-describedby={error ? `${props.id}-error` : undefined}
        />

        {/* Helper text or error */}
        {helperText && !error && (
          <p className="text-sm text-muted-foreground">
            {helperText}
          </p>
        )}

        {error && (
          <p
            id={`${props.id}-error`}
            className="text-sm text-destructive"
            role="alert"
          >
            {error}
          </p>
        )}
      </div>
    );
  },
);

ComponentName.displayName = 'ComponentName';

export default ComponentName;
````

---

## Template: ComponentName.types.ts

```typescript
import type { InputHTMLAttributes } from "react";

/**
 * Variant options for ComponentName
 */
export type ComponentVariant = "default" | "error" | "success";

/**
 * Size options for ComponentName
 */
export type ComponentSize = "sm" | "md" | "lg";

/**
 * Props for ComponentName molecule
 */
export interface ComponentNameProps
  extends Omit<InputHTMLAttributes<HTMLInputElement>, "size"> {
  /**
   * Visual variant of the molecule
   * @default 'default'
   */
  variant?: ComponentVariant;

  /**
   * Size of the molecule
   * @default 'md'
   */
  size?: ComponentSize;

  /**
   * Label text for the field
   */
  label?: string;

  /**
   * Helper text displayed below input
   */
  helperText?: string;

  /**
   * Error message to display
   */
  error?: string;

  /**
   * Whether field is required
   * @default false
   */
  required?: boolean;

  /**
   * Disabled state
   * @default false
   */
  disabled?: boolean;

  /**
   * Custom className for the container
   */
  className?: string;

  /**
   * Change handler
   */
  onChange?: (e: React.ChangeEvent<HTMLInputElement>) => void;
}
```

---

## Template: index.ts

```typescript
export { ComponentName, default } from "./ComponentName";
export type {
  ComponentNameProps,
  ComponentVariant,
  ComponentSize,
} from "./ComponentName.types";
```

---

## Molecule Component Checklist

Before creating a molecule, ensure:

### ✅ Definition Validation

- [ ] Component is composed of **2-5 atoms**
- [ ] Component has a **single clear purpose**
- [ ] Component is **reusable across contexts**
- [ ] Component MAY have **simple internal state**

### ✅ Composition

- [ ] Uses existing atoms from `@/components/atoms`
- [ ] Does NOT create inline atoms (use existing ones)
- [ ] Atoms work together as a cohesive unit
- [ ] Clear parent-child relationship

### ✅ Props Design

- [ ] Has clear `variant` options (if applicable)
- [ ] Has clear `size` options (matches atom sizes)
- [ ] Props are specific to the molecule's purpose
- [ ] Does NOT expose all atom props individually
- [ ] Uses sensible defaults

### ✅ State Management

- [ ] ONLY simple local state (e.g., `isOpen`, `value`)
- [ ] NO complex state management (Redux, Zustand)
- [ ] NO data fetching
- [ ] State is minimal and focused

### ✅ Styling

- [ ] Uses `cn()` for class composition
- [ ] Inherits atom styles
- [ ] Only adds layout/spacing between atoms
- [ ] Responsive design considered

### ✅ Accessibility

- [ ] Labels associated with inputs
- [ ] Error messages have proper ARIA
- [ ] Focus management works correctly
- [ ] Keyboard navigation supported

### ✅ TypeScript

- [ ] Types in separate `.types.ts` file
- [ ] Props extend relevant HTML attributes
- [ ] All props documented
- [ ] Exports types from `index.ts`

### ✅ File Structure

- [ ] `ComponentName.tsx` created
- [ ] `ComponentName.types.ts` created
- [ ] `index.ts` barrel export created
- [ ] Component has `displayName` set

---

## Common Molecules Examples

### 1. FormField

- **Atoms**: Label + Input + ErrorMessage
- **Purpose**: Single form input with label and validation
- **Special Props**: error, helperText, required

### 2. SearchBar

- **Atoms**: Input + Icon + Button
- **Purpose**: Search input with submit button
- **Special Props**: onSearch, placeholder, loading

### 3. ColorPickerField

- **Atoms**: Label + ColorPicker + Input
- **Purpose**: Color selection with hex input
- **Special Props**: value, onChange, presets

### 4. CardHeader

- **Atoms**: Avatar + Typography + Badge
- **Purpose**: Card header with user info
- **Special Props**: user, subtitle, badge

### 5. SliderControl

- **Atoms**: Label + Slider + Input
- **Purpose**: Numeric value control
- **Special Props**: min, max, step, unit

---

## Anti-Patterns

### ❌ DON'T: Fetch Data

```typescript
// ComponentName.tsx - BAD
const ComponentName = () => {
  const { data } = useQuery(); // ❌ Data fetching in molecule

  return <div>{data}</div>;
};
```

### ❌ DON'T: Use Complex Business Logic

```typescript
// ComponentName.tsx - BAD
const ComponentName = () => {
  const dispatch = useDispatch(); // ❌ Redux in molecule
  const handleSubmit = () => {
    // ❌ Complex business logic
    dispatch(validateUser());
    dispatch(saveToDatabase());
  };
};
```

### ❌ DON'T: Compose Too Many Atoms

```typescript
// ComponentName.tsx - BAD (This is an Organism)
const ComponentName = () => (
  <div>
    <Input />
    <Select />
    <Checkbox />
    <DatePicker />
    <Button />
    <Button />
  </div>
);
```

### ❌ DON'T: Create Inline Atoms

```typescript
// ComponentName.tsx - BAD
const ComponentName = () => (
  <div>
    <button className="...">Custom Button</button> {/* ❌ Should use Button atom */}
  </div>
);
```

### ❌ DON'T: Use Context/Providers

```typescript
// ComponentName.tsx - BAD
const ComponentName = () => {
  const theme = useTheme(); // ⚠️ Only if absolutely necessary
  const user = useUser(); // ❌ User context in molecule

  return <div />;
};
```

---

## Molecule Composition Patterns

### Pattern 1: Field Pattern (Label + Input + Helper)

```typescript
<Container>
  <Label />
  <Input />
  <HelperText />
</Container>
```

### Pattern 2: Control Pattern (Label + Control + Value)

```typescript
<Container>
  <Label />
  <Slider />
  <ValueDisplay />
</Container>
```

### Pattern 3: Action Pattern (Content + Button)

```typescript
<Container>
  <Input />
  <Button />
</Container>
```

### Pattern 4: Info Pattern (Icon + Typography)

```typescript
<Container>
  <Icon />
  <Typography />
</Container>
```

---

## After Creating Component

Once you've created the molecule:

1. **Run frontend-testing-expert agent** to generate tests
2. **Run frontend-testing-expert agent** to generate Storybook stories
3. **Add to barrel export** in `molecules/index.ts`
4. **Verify component** in Storybook (`npm run storybook`)
5. **Run tests** (`npm run test ComponentName.test.tsx`)
6. **Verify coverage** (`npm run test:coverage` - target 90%+)

---

## Related Documentation

- [Atomic Design Architecture](/docs/00-conventions/atomic-design-architecture.md)
- [Component Structure and Testing](/docs/00-conventions/component-structure-and-testing.md)
- [Component Atom Template](/docs/02-components/component-atom-template.md)
- [Component Organism Template](/docs/02-components/component-organism-template.md)

---

**Last Updated**: 2025-01-09
