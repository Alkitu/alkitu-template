# ALI-117: DB Work Locations Management (WorkLocation)

## Metadata
- **Issue Key**: ALI-117
- **Type**: Tarea
- **Status**: Discovery
- **Priority**: Medium
- **Assignee**: Luis Eduardo Urdaneta Martucci
- **Created**: 2025-11-18T02:59:26.208+0100
- **Updated**: 2025-11-23T22:07:22.346+0100
- **Sprint**: Diseño Interfaz y Data Base (ID: 37)

## Description

Modelar y persistir las ubicaciones de trabajo reutilizables de cada cliente para que puedan seleccionarse al crear solicitudes y consultarse en el detalle de cada request.

**Modelos / campos clave:**

* `WorkLocation.userId`
* `street`, `building?`, `tower?`, `floor?`, `unit?`
* `city`, `zip`, `state`

### ¿Dónde se usa en el sitemap?

**Pantallas:**

* **New Request – Step 1: "Choose Location" [Client] (ALI-36)**

    * Lista las ubicaciones desde `WorkLocation` filtradas por `userId`:

        * Se muestran campos como `street`, `building`, `floor`, `city`, `zip`, `state`.

    * El formulario de "Nueva ubicación" crea un nuevo registro con esos campos.

* **Request Detail – "Request Overview & Status" [Client] (ALI-41)**

    * Muestra la ubicación ligada al `locationId`:

        * Dirección completa tomada de `WorkLocation` (street, city, state, etc.).


* **Request Detail – "Job Details & Completion" [Employee] (ALI-43)**

    * El empleado ve la misma dirección para saber dónde debe prestar el servicio.

* **Request Detail – "Request Management & Assignment" [Admin] (ALI-44)**

    * Admin visualiza la ubicación asociada a la solicitud para coordinar logística.

* **Calendar – "Execution Schedule Planner" [Admin] (ALI-55)**

    * Cada evento del calendario representa un `Request`.
    * La ubicación se utiliza como información adicional en el detalle/contexto del evento (por ejemplo, tooltip o panel lateral).

## Schema Definition

```prisma
/// EPIC DB-3 – Work Locations Management (WorkLocation)

model WorkLocation {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  user      User     @relation("UserLocations", fields: [userId], references: [id])
  userId    String   @db.ObjectId
  street    String
  building  String?
  tower     String?
  floor     String?
  unit      String?
  city      String
  zip       String
  state     String
  createdAt DateTime @default(now())
}
```

## Links
- [View in Jira](https://alkitu.atlassian.net/browse/ALI-117)
